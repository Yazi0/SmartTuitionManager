{"file_contents":{"main.py":{"content":"def main():\n    print(\"Hello from repl-nix-workspace!\")\n\n\nif __name__ == \"__main__\":\n    main()\n","size_bytes":96},"backend/manage.py":{"content":"#!/usr/bin/env python\n\"\"\"Django's command-line utility for administrative tasks.\"\"\"\nimport os\nimport sys\n\n\ndef main():\n    \"\"\"Run administrative tasks.\"\"\"\n    os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'tuition_manager.settings')\n    try:\n        from django.core.management import execute_from_command_line\n    except ImportError as exc:\n        raise ImportError(\n            \"Couldn't import Django. Are you sure it's installed and \"\n            \"available on your PYTHONPATH environment variable? Did you \"\n            \"forget to activate a virtual environment?\"\n        ) from exc\n    execute_from_command_line(sys.argv)\n\n\nif __name__ == '__main__':\n    main()\n","size_bytes":671},"backend/attendance/migrations/0001_initial.py":{"content":"# Generated by Django 4.2.7 on 2025-11-06 05:08\n\nfrom django.conf import settings\nfrom django.db import migrations, models\nimport django.db.models.deletion\n\n\nclass Migration(migrations.Migration):\n\n    initial = True\n\n    dependencies = [\n        migrations.swappable_dependency(settings.AUTH_USER_MODEL),\n        ('students', '0001_initial'),\n        ('classes', '0001_initial'),\n    ]\n\n    operations = [\n        migrations.CreateModel(\n            name='Attendance',\n            fields=[\n                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),\n                ('date', models.DateField(auto_now_add=True)),\n                ('time', models.TimeField(auto_now_add=True)),\n                ('sms_sent', models.BooleanField(default=False)),\n                ('created_at', models.DateTimeField(auto_now_add=True)),\n                ('class_attended', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='attendances', to='classes.class')),\n                ('marked_by', models.ForeignKey(limit_choices_to={'role__in': ['owner', 'teacher']}, null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),\n                ('student', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='attendances', to='students.student')),\n            ],\n            options={\n                'ordering': ['-date', '-time'],\n                'unique_together': {('student', 'class_attended', 'date')},\n            },\n        ),\n    ]\n","size_bytes":1548},"backend/attendance/admin.py":{"content":"from django.contrib import admin\n\n# Register your models here.\n","size_bytes":63},"backend/attendance/apps.py":{"content":"from django.apps import AppConfig\n\n\nclass AttendanceConfig(AppConfig):\n    default_auto_field = 'django.db.models.BigAutoField'\n    name = 'attendance'\n","size_bytes":152},"backend/students/models.py":{"content":"from django.db import models\nfrom django.conf import settings\nimport qrcode\nfrom io import BytesIO\nfrom django.core.files import File\nfrom PIL import Image\nimport os\n\nclass Student(models.Model):\n    user = models.OneToOneField(\n        settings.AUTH_USER_MODEL, \n        on_delete=models.CASCADE,\n        limit_choices_to={'role': 'student'}\n    )\n    full_name = models.CharField(max_length=200)\n    date_of_birth = models.DateField()\n    parent_name = models.CharField(max_length=200)\n    parent_phone = models.CharField(max_length=15)\n    parent_email = models.EmailField(blank=True)\n    address = models.TextField()\n    assigned_class = models.ForeignKey(\n        'classes.Class', \n        on_delete=models.SET_NULL, \n        null=True, \n        related_name='students'\n    )\n    qr_code = models.ImageField(upload_to='qr_codes/', blank=True)\n    enrollment_date = models.DateField(auto_now_add=True)\n    is_active = models.BooleanField(default=True)\n    created_at = models.DateTimeField(auto_now_add=True)\n    updated_at = models.DateTimeField(auto_now=True)\n    \n    def __str__(self):\n        return self.full_name\n    \n    def generate_qr_code(self):\n        qr = qrcode.QRCode(\n            version=1,\n            error_correction=qrcode.constants.ERROR_CORRECT_L,\n            box_size=10,\n            border=4,\n        )\n        qr_data = f\"STUDENT:{self.id}:{self.full_name}\"\n        qr.add_data(qr_data)\n        qr.make(fit=True)\n        \n        img = qr.make_image(fill_color=\"black\", back_color=\"white\")\n        \n        buffer = BytesIO()\n        img.save(buffer, 'PNG')\n        buffer.seek(0)\n        \n        filename = f'student_{self.id}_qr.png'\n        self.qr_code.save(filename, File(buffer), save=False)\n        buffer.close()\n    \n    def save(self, *args, **kwargs):\n        is_new = self.pk is None\n        super().save(*args, **kwargs)\n        if is_new or not self.qr_code:\n            self.generate_qr_code()\n            super().save(update_fields=['qr_code'])\n","size_bytes":1992},"backend/attendance/serializers.py":{"content":"from rest_framework import serializers\nfrom .models import Attendance\nfrom students.models import Student\n\nclass AttendanceSerializer(serializers.ModelSerializer):\n    student_name = serializers.CharField(source='student.full_name', read_only=True)\n    class_name = serializers.CharField(source='class_attended.name', read_only=True)\n    marked_by_name = serializers.CharField(source='marked_by.get_full_name', read_only=True)\n    \n    class Meta:\n        model = Attendance\n        fields = ['id', 'student', 'student_name', 'class_attended', 'class_name', \n                  'date', 'time', 'marked_by', 'marked_by_name', 'sms_sent', 'created_at']\n        read_only_fields = ['id', 'date', 'time', 'sms_sent', 'created_at']\n\nclass MarkAttendanceSerializer(serializers.Serializer):\n    qr_data = serializers.CharField()\n    \n    def validate_qr_data(self, value):\n        try:\n            parts = value.split(':')\n            if len(parts) != 3 or parts[0] != 'STUDENT':\n                raise serializers.ValidationError(\"Invalid QR code format\")\n            \n            student_id = int(parts[1])\n            student = Student.objects.get(id=student_id)\n            return {'student': student}\n        except (ValueError, Student.DoesNotExist):\n            raise serializers.ValidationError(\"Invalid student QR code\")\n","size_bytes":1321},"backend/tuition_manager/__init__.py":{"content":"","size_bytes":0},"backend/accounts/admin.py":{"content":"from django.contrib import admin\n\n# Register your models here.\n","size_bytes":63},"frontend/src/index.css":{"content":"@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n@layer base {\n  :root {\n    --background: 0 0% 100%;\n    --foreground: 222.2 84% 4.9%;\n    --card: 0 0% 100%;\n    --card-foreground: 222.2 84% 4.9%;\n    --popover: 0 0% 100%;\n    --popover-foreground: 222.2 84% 4.9%;\n    --primary: 221.2 83.2% 53.3%;\n    --primary-foreground: 210 40% 98%;\n    --secondary: 210 40% 96.1%;\n    --secondary-foreground: 222.2 47.4% 11.2%;\n    --muted: 210 40% 96.1%;\n    --muted-foreground: 215.4 16.3% 46.9%;\n    --accent: 210 40% 96.1%;\n    --accent-foreground: 222.2 47.4% 11.2%;\n    --destructive: 0 84.2% 60.2%;\n    --destructive-foreground: 210 40% 98%;\n    --border: 214.3 31.8% 91.4%;\n    --input: 214.3 31.8% 91.4%;\n    --ring: 221.2 83.2% 53.3%;\n    --radius: 0.5rem;\n  }\n}\n","size_bytes":774},"backend/classes/migrations/0001_initial.py":{"content":"# Generated by Django 4.2.7 on 2025-11-06 05:08\n\nfrom django.conf import settings\nfrom django.db import migrations, models\nimport django.db.models.deletion\n\n\nclass Migration(migrations.Migration):\n\n    initial = True\n\n    dependencies = [\n        migrations.swappable_dependency(settings.AUTH_USER_MODEL),\n    ]\n\n    operations = [\n        migrations.CreateModel(\n            name='Class',\n            fields=[\n                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),\n                ('name', models.CharField(max_length=100)),\n                ('subject', models.CharField(max_length=100)),\n                ('fee_per_month', models.DecimalField(decimal_places=2, max_digits=10)),\n                ('schedule', models.CharField(help_text='e.g., Mon/Wed/Fri 4-6 PM', max_length=200)),\n                ('created_at', models.DateTimeField(auto_now_add=True)),\n                ('updated_at', models.DateTimeField(auto_now=True)),\n                ('teacher', models.ForeignKey(limit_choices_to={'role': 'teacher'}, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='classes_taught', to=settings.AUTH_USER_MODEL)),\n            ],\n            options={\n                'verbose_name_plural': 'Classes',\n            },\n        ),\n    ]\n","size_bytes":1307},"backend/classes/migrations/__init__.py":{"content":"","size_bytes":0},"frontend/tailwind.config.js":{"content":"export default {\n  darkMode: [\"class\"],\n  content: [\n    \"./index.html\",\n    \"./src/**/*.{js,ts,jsx,tsx}\",\n  ],\n  theme: {\n    extend: {\n      colors: {\n        border: \"hsl(var(--border))\",\n        input: \"hsl(var(--input))\",\n        ring: \"hsl(var(--ring))\",\n        background: \"hsl(var(--background))\",\n        foreground: \"hsl(var(--foreground))\",\n        primary: {\n          DEFAULT: \"hsl(var(--primary))\",\n          foreground: \"hsl(var(--primary-foreground))\",\n        },\n        secondary: {\n          DEFAULT: \"hsl(var(--secondary))\",\n          foreground: \"hsl(var(--secondary-foreground))\",\n        },\n        destructive: {\n          DEFAULT: \"hsl(var(--destructive))\",\n          foreground: \"hsl(var(--destructive-foreground))\",\n        },\n        muted: {\n          DEFAULT: \"hsl(var(--muted))\",\n          foreground: \"hsl(var(--muted-foreground))\",\n        },\n        accent: {\n          DEFAULT: \"hsl(var(--accent))\",\n          foreground: \"hsl(var(--accent-foreground))\",\n        },\n      },\n      borderRadius: {\n        lg: \"var(--radius)\",\n        md: \"calc(var(--radius) - 2px)\",\n        sm: \"calc(var(--radius) - 4px)\",\n      },\n    },\n  },\n  plugins: [],\n}\n","size_bytes":1182},"backend/students/views.py":{"content":"from rest_framework import generics, permissions\nfrom .models import Student\nfrom .serializers import StudentSerializer, StudentCreateSerializer\nfrom accounts.permissions import IsOwner, IsOwnerOrTeacher\n\nclass StudentListCreateView(generics.ListCreateAPIView):\n    queryset = Student.objects.all()\n    \n    def get_permissions(self):\n        if self.request.method == 'POST':\n            return [IsOwner()]\n        return [IsOwnerOrTeacher()]\n    \n    def get_serializer_class(self):\n        if self.request.method == 'POST':\n            return StudentCreateSerializer\n        return StudentSerializer\n\nclass StudentDetailView(generics.RetrieveUpdateDestroyAPIView):\n    queryset = Student.objects.all()\n    serializer_class = StudentSerializer\n    \n    def get_permissions(self):\n        if self.request.method in ['GET']:\n            return [IsOwnerOrTeacher()]\n        return [IsOwner()]\n","size_bytes":892},"backend/accounts/__init__.py":{"content":"","size_bytes":0},"frontend/postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","size_bytes":80},"backend/classes/tests.py":{"content":"from django.test import TestCase\n\n# Create your tests here.\n","size_bytes":60},"backend/students/urls.py":{"content":"from django.urls import path\nfrom .views import StudentListCreateView, StudentDetailView\n\nurlpatterns = [\n    path('', StudentListCreateView.as_view(), name='student-list-create'),\n    path('<int:pk>/', StudentDetailView.as_view(), name='student-detail'),\n]\n","size_bytes":258},"backend/payments/apps.py":{"content":"from django.apps import AppConfig\n\n\nclass PaymentsConfig(AppConfig):\n    default_auto_field = 'django.db.models.BigAutoField'\n    name = 'payments'\n","size_bytes":148},"backend/tuition_manager/wsgi.py":{"content":"\"\"\"\nWSGI config for tuition_manager project.\n\nIt exposes the WSGI callable as a module-level variable named ``application``.\n\nFor more information on this file, see\nhttps://docs.djangoproject.com/en/4.2/howto/deployment/wsgi/\n\"\"\"\n\nimport os\n\nfrom django.core.wsgi import get_wsgi_application\n\nos.environ.setdefault('DJANGO_SETTINGS_MODULE', 'tuition_manager.settings')\n\napplication = get_wsgi_application()\n","size_bytes":407},"frontend/src/contexts/AuthContext.jsx":{"content":"import { createContext, useContext, useState, useEffect } from 'react'\nimport api from '../utils/api'\n\nconst AuthContext = createContext()\n\nexport const useAuth = () => {\n  const context = useContext(AuthContext)\n  if (!context) {\n    throw new Error('useAuth must be used within AuthProvider')\n  }\n  return context\n}\n\nexport const AuthProvider = ({ children }) => {\n  const [user, setUser] = useState(null)\n  const [loading, setLoading] = useState(true)\n\n  useEffect(() => {\n    const token = localStorage.getItem('token')\n    const storedUser = localStorage.getItem('user')\n    \n    if (token && storedUser) {\n      setUser(JSON.parse(storedUser))\n    }\n    setLoading(false)\n  }, [])\n\n  const login = async (username, password) => {\n    try {\n      const response = await api.post('/auth/login/', { username, password })\n      const { access, user: userData } = response.data\n      \n      localStorage.setItem('token', access)\n      localStorage.setItem('user', JSON.stringify(userData))\n      setUser(userData)\n      \n      return { success: true, user: userData }\n    } catch (error) {\n      return { success: false, error: error.response?.data?.error || 'Login failed' }\n    }\n  }\n\n  const logout = () => {\n    localStorage.removeItem('token')\n    localStorage.removeItem('user')\n    setUser(null)\n  }\n\n  return (\n    <AuthContext.Provider value={{ user, login, logout, loading }}>\n      {!loading && children}\n    </AuthContext.Provider>\n  )\n}\n","size_bytes":1451},"backend/students/apps.py":{"content":"from django.apps import AppConfig\n\n\nclass StudentsConfig(AppConfig):\n    default_auto_field = 'django.db.models.BigAutoField'\n    name = 'students'\n","size_bytes":148},"frontend/src/pages/Login.jsx":{"content":"import { useState } from 'react'\nimport { useNavigate } from 'react-router-dom'\nimport { useAuth } from '../contexts/AuthContext'\n\nfunction Login() {\n  const [username, setUsername] = useState('')\n  const [password, setPassword] = useState('')\n  const [error, setError] = useState('')\n  const [loading, setLoading] = useState(false)\n  const { login } = useAuth()\n  const navigate = useNavigate()\n\n  const handleSubmit = async (e) => {\n    e.preventDefault()\n    setError('')\n    setLoading(true)\n\n    const result = await login(username, password)\n\n    if (result.success) {\n      if (result.user.role === 'owner') {\n        navigate('/owner')\n      } else if (result.user.role === 'teacher') {\n        navigate('/teacher')\n      }\n    } else {\n      setError(result.error)\n    }\n    \n    setLoading(false)\n  }\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100\">\n      <div className=\"bg-white p-8 rounded-lg shadow-lg w-full max-w-md\">\n        <h1 className=\"text-3xl font-bold text-center mb-2 text-gray-800\">Smart Tuition Manager</h1>\n        <p className=\"text-center text-gray-600 mb-6\">Login to your account</p>\n        \n        <form onSubmit={handleSubmit} className=\"space-y-4\">\n          {error && (\n            <div className=\"bg-red-50 text-red-600 p-3 rounded-md text-sm\">\n              {error}\n            </div>\n          )}\n          \n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Username\n            </label>\n            <input\n              type=\"text\"\n              value={username}\n              onChange={(e) => setUsername(e.target.value)}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              required\n            />\n          </div>\n          \n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Password\n            </label>\n            <input\n              type=\"password\"\n              value={password}\n              onChange={(e) => setPassword(e.target.value)}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              required\n            />\n          </div>\n          \n          <button\n            type=\"submit\"\n            disabled={loading}\n            className=\"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50\"\n          >\n            {loading ? 'Logging in...' : 'Login'}\n          </button>\n        </form>\n      </div>\n    </div>\n  )\n}\n\nexport default Login\n","size_bytes":2754},"frontend/src/App.jsx":{"content":"import { BrowserRouter as Router, Routes, Route, Navigate } from 'react-router-dom'\nimport { AuthProvider, useAuth } from './contexts/AuthContext'\nimport Login from './pages/Login'\nimport OwnerDashboard from './pages/OwnerDashboard'\nimport TeacherDashboard from './pages/TeacherDashboard'\n\nfunction ProtectedRoute({ children, allowedRoles }) {\n  const { user } = useAuth()\n  \n  if (!user) {\n    return <Navigate to=\"/login\" />\n  }\n  \n  if (allowedRoles && !allowedRoles.includes(user.role)) {\n    return <Navigate to=\"/login\" />\n  }\n  \n  return children\n}\n\nfunction App() {\n  return (\n    <Router>\n      <AuthProvider>\n        <Routes>\n          <Route path=\"/login\" element={<Login />} />\n          <Route\n            path=\"/owner/*\"\n            element={\n              <ProtectedRoute allowedRoles={['owner']}>\n                <OwnerDashboard />\n              </ProtectedRoute>\n            }\n          />\n          <Route\n            path=\"/teacher/*\"\n            element={\n              <ProtectedRoute allowedRoles={['teacher']}>\n                <TeacherDashboard />\n              </ProtectedRoute>\n            }\n          />\n          <Route path=\"/\" element={<Navigate to=\"/login\" />} />\n        </Routes>\n      </AuthProvider>\n    </Router>\n  )\n}\n\nexport default App\n","size_bytes":1274},"backend/accounts/serializers.py":{"content":"from rest_framework import serializers\nfrom django.contrib.auth import get_user_model\nfrom django.contrib.auth.password_validation import validate_password\n\nUser = get_user_model()\n\nclass UserSerializer(serializers.ModelSerializer):\n    class Meta:\n        model = User\n        fields = ['id', 'username', 'email', 'first_name', 'last_name', 'role', 'phone']\n        read_only_fields = ['id']\n\nclass RegisterSerializer(serializers.ModelSerializer):\n    password = serializers.CharField(write_only=True, required=True, validators=[validate_password])\n    password2 = serializers.CharField(write_only=True, required=True)\n\n    class Meta:\n        model = User\n        fields = ['username', 'password', 'password2', 'email', 'first_name', 'last_name', 'phone']\n\n    def validate(self, attrs):\n        if attrs['password'] != attrs['password2']:\n            raise serializers.ValidationError({\"password\": \"Password fields didn't match.\"})\n        return attrs\n\n    def create(self, validated_data):\n        validated_data.pop('password2')\n        user = User.objects.create_user(**validated_data)\n        return user\n\nclass TeacherSerializer(serializers.ModelSerializer):\n    class Meta:\n        model = User\n        fields = ['id', 'username', 'email', 'first_name', 'last_name', 'phone']\n        read_only_fields = ['id']\n","size_bytes":1320},"backend/classes/apps.py":{"content":"from django.apps import AppConfig\n\n\nclass ClassesConfig(AppConfig):\n    default_auto_field = 'django.db.models.BigAutoField'\n    name = 'classes'\n","size_bytes":146},"backend/students/admin.py":{"content":"from django.contrib import admin\n\n# Register your models here.\n","size_bytes":63},"backend/accounts/permissions.py":{"content":"from rest_framework import permissions\n\nclass IsOwner(permissions.BasePermission):\n    def has_permission(self, request, view):\n        return request.user and request.user.is_authenticated and request.user.role == 'owner'\n\nclass IsOwnerOrTeacher(permissions.BasePermission):\n    def has_permission(self, request, view):\n        return request.user and request.user.is_authenticated and request.user.role in ['owner', 'teacher']\n\nclass IsTeacher(permissions.BasePermission):\n    def has_permission(self, request, view):\n        return request.user and request.user.is_authenticated and request.user.role == 'teacher'\n","size_bytes":617},"backend/students/tests.py":{"content":"from django.test import TestCase\n\n# Create your tests here.\n","size_bytes":60},"backend/tuition_manager/settings.py":{"content":"\"\"\"\nDjango settings for tuition_manager project.\n\nGenerated by 'django-admin startproject' using Django 4.2.7.\n\nFor more information on this file, see\nhttps://docs.djangoproject.com/en/4.2/topics/settings/\n\nFor the full list of settings and their values, see\nhttps://docs.djangoproject.com/en/4.2/ref/settings/\n\"\"\"\n\nfrom pathlib import Path\nfrom datetime import timedelta\nimport os\n\n# Build paths inside the project like this: BASE_DIR / 'subdir'.\nBASE_DIR = Path(__file__).resolve().parent.parent\n\n\n# Quick-start development settings - unsuitable for production\n# See https://docs.djangoproject.com/en/4.2/howto/deployment/checklist/\n\n# SECURITY WARNING: keep the secret key used in production secret!\nSECRET_KEY = os.environ.get('SESSION_SECRET', 'django-insecure-*(&n_ra%6syf=nv91!gs^9le2$k1^5gp8r^n3!q_+v_$0$9nk3')\n\n# SECURITY WARNING: don't run with debug turned on in production!\nDEBUG = True\n\nALLOWED_HOSTS = ['*']\n\n\n# Application definition\n\nINSTALLED_APPS = [\n    'django.contrib.admin',\n    'django.contrib.auth',\n    'django.contrib.contenttypes',\n    'django.contrib.sessions',\n    'django.contrib.messages',\n    'django.contrib.staticfiles',\n    'rest_framework',\n    'rest_framework_simplejwt',\n    'corsheaders',\n    'accounts',\n    'students',\n    'classes',\n    'attendance',\n    'payments',\n]\n\nMIDDLEWARE = [\n    'django.middleware.security.SecurityMiddleware',\n    'corsheaders.middleware.CorsMiddleware',\n    'django.contrib.sessions.middleware.SessionMiddleware',\n    'django.middleware.common.CommonMiddleware',\n    'django.middleware.csrf.CsrfViewMiddleware',\n    'django.contrib.auth.middleware.AuthenticationMiddleware',\n    'django.contrib.messages.middleware.MessageMiddleware',\n    'django.middleware.clickjacking.XFrameOptionsMiddleware',\n]\n\nROOT_URLCONF = 'tuition_manager.urls'\n\nTEMPLATES = [\n    {\n        'BACKEND': 'django.template.backends.django.DjangoTemplates',\n        'DIRS': [],\n        'APP_DIRS': True,\n        'OPTIONS': {\n            'context_processors': [\n                'django.template.context_processors.debug',\n                'django.template.context_processors.request',\n                'django.contrib.auth.context_processors.auth',\n                'django.contrib.messages.context_processors.messages',\n            ],\n        },\n    },\n]\n\nWSGI_APPLICATION = 'tuition_manager.wsgi.application'\n\n\n# Database\n# https://docs.djangoproject.com/en/4.2/ref/settings/#databases\n\nDATABASES = {\n    'default': {\n        'ENGINE': 'django.db.backends.sqlite3',\n        'NAME': BASE_DIR / 'db.sqlite3',\n    }\n}\n\n\n# Password validation\n# https://docs.djangoproject.com/en/4.2/ref/settings/#auth-password-validators\n\nAUTH_PASSWORD_VALIDATORS = [\n    {\n        'NAME': 'django.contrib.auth.password_validation.UserAttributeSimilarityValidator',\n    },\n    {\n        'NAME': 'django.contrib.auth.password_validation.MinimumLengthValidator',\n    },\n    {\n        'NAME': 'django.contrib.auth.password_validation.CommonPasswordValidator',\n    },\n    {\n        'NAME': 'django.contrib.auth.password_validation.NumericPasswordValidator',\n    },\n]\n\n\n# Internationalization\n# https://docs.djangoproject.com/en/4.2/topics/i18n/\n\nLANGUAGE_CODE = 'en-us'\n\nTIME_ZONE = 'UTC'\n\nUSE_I18N = True\n\nUSE_TZ = True\n\n\n# Static files (CSS, JavaScript, Images)\n# https://docs.djangoproject.com/en/4.2/howto/static-files/\n\nSTATIC_URL = 'static/'\n\n# Default primary key field type\n# https://docs.djangoproject.com/en/4.2/ref/settings/#default-auto-field\n\nDEFAULT_AUTO_FIELD = 'django.db.models.BigAutoField'\n\n# Custom User Model\nAUTH_USER_MODEL = 'accounts.User'\n\n# CORS Settings\nCORS_ALLOW_ALL_ORIGINS = True\nCORS_ALLOW_CREDENTIALS = True\n\n# REST Framework Settings\nREST_FRAMEWORK = {\n    'DEFAULT_AUTHENTICATION_CLASSES': (\n        'rest_framework_simplejwt.authentication.JWTAuthentication',\n    ),\n    'DEFAULT_PERMISSION_CLASSES': (\n        'rest_framework.permissions.IsAuthenticated',\n    ),\n}\n\n# JWT Settings\nSIMPLE_JWT = {\n    'ACCESS_TOKEN_LIFETIME': timedelta(days=1),\n    'REFRESH_TOKEN_LIFETIME': timedelta(days=7),\n    'ROTATE_REFRESH_TOKENS': False,\n    'BLACKLIST_AFTER_ROTATION': True,\n    'ALGORITHM': 'HS256',\n    'SIGNING_KEY': SECRET_KEY,\n    'AUTH_HEADER_TYPES': ('Bearer',),\n}\n\n# Media Files (for QR codes)\nMEDIA_URL = '/media/'\nMEDIA_ROOT = BASE_DIR / 'media'\n\n# QR Code Directory\nQR_CODE_DIR = MEDIA_ROOT / 'qr_codes'\nQR_CODE_DIR.mkdir(parents=True, exist_ok=True)\n\n# Twilio Settings\nTWILIO_ACCOUNT_SID = os.environ.get('TWILIO_ACCOUNT_SID', '')\nTWILIO_AUTH_TOKEN = os.environ.get('TWILIO_AUTH_TOKEN', '')\nTWILIO_PHONE_NUMBER = os.environ.get('TWILIO_PHONE_NUMBER', '')\n","size_bytes":4612},"backend/tuition_manager/urls.py":{"content":"\"\"\"\nURL configuration for tuition_manager project.\n\nThe `urlpatterns` list routes URLs to views. For more information please see:\n    https://docs.djangoproject.com/en/4.2/topics/http/urls/\nExamples:\nFunction views\n    1. Add an import:  from my_app import views\n    2. Add a URL to urlpatterns:  path('', views.home, name='home')\nClass-based views\n    1. Add an import:  from other_app.views import Home\n    2. Add a URL to urlpatterns:  path('', Home.as_view(), name='home')\nIncluding another URLconf\n    1. Import the include() function: from django.urls import include, path\n    2. Add a URL to urlpatterns:  path('blog/', include('blog.urls'))\n\"\"\"\nfrom django.contrib import admin\nfrom django.urls import path, include\nfrom django.conf import settings\nfrom django.conf.urls.static import static\n\nurlpatterns = [\n    path('admin/', admin.site.urls),\n    path('api/auth/', include('accounts.urls')),\n    path('api/students/', include('students.urls')),\n    path('api/classes/', include('classes.urls')),\n    path('api/attendance/', include('attendance.urls')),\n    path('api/payments/', include('payments.urls')),\n]\n\nif settings.DEBUG:\n    urlpatterns += static(settings.MEDIA_URL, document_root=settings.MEDIA_ROOT)\n","size_bytes":1220},"backend/attendance/views.py":{"content":"from rest_framework import generics, permissions, status\nfrom rest_framework.views import APIView\nfrom rest_framework.response import Response\nfrom django.utils import timezone\nfrom datetime import datetime\nfrom .models import Attendance\nfrom .serializers import AttendanceSerializer, MarkAttendanceSerializer\nfrom utils.sms import send_attendance_sms\nfrom accounts.permissions import IsOwnerOrTeacher\n\nclass AttendanceListView(generics.ListAPIView):\n    serializer_class = AttendanceSerializer\n    permission_classes = (IsOwnerOrTeacher,)\n    \n    def get_queryset(self):\n        queryset = Attendance.objects.all()\n        date = self.request.query_params.get('date', None)\n        class_id = self.request.query_params.get('class_id', None)\n        student_id = self.request.query_params.get('student_id', None)\n        \n        if date:\n            queryset = queryset.filter(date=date)\n        if class_id:\n            queryset = queryset.filter(class_attended_id=class_id)\n        if student_id:\n            queryset = queryset.filter(student_id=student_id)\n        \n        return queryset\n\nclass MarkAttendanceView(APIView):\n    permission_classes = (IsOwnerOrTeacher,)\n    \n    def post(self, request):\n        serializer = MarkAttendanceSerializer(data=request.data)\n        \n        if serializer.is_valid():\n            student = serializer.validated_data['qr_data']['student']\n            \n            if not student.assigned_class:\n                return Response(\n                    {'error': 'Student is not assigned to any class'}, \n                    status=status.HTTP_400_BAD_REQUEST\n                )\n            \n            today = timezone.now().date()\n            attendance, created = Attendance.objects.get_or_create(\n                student=student,\n                class_attended=student.assigned_class,\n                date=today,\n                defaults={'marked_by': request.user}\n            )\n            \n            if not created:\n                return Response(\n                    {'message': 'Attendance already marked for today'}, \n                    status=status.HTTP_200_OK\n                )\n            \n            sms_sent = send_attendance_sms(student, student.assigned_class.name)\n            attendance.sms_sent = sms_sent\n            attendance.save()\n            \n            return Response(\n                AttendanceSerializer(attendance).data, \n                status=status.HTTP_201_CREATED\n            )\n        \n        return Response(serializer.errors, status=status.HTTP_400_BAD_REQUEST)\n\nclass DailyReportView(APIView):\n    permission_classes = (IsOwnerOrTeacher,)\n    \n    def get(self, request):\n        date_str = request.query_params.get('date', None)\n        if date_str:\n            date = datetime.strptime(date_str, '%Y-%m-%d').date()\n        else:\n            date = timezone.now().date()\n        \n        if request.user.role == 'teacher':\n            attendances = Attendance.objects.filter(\n                date=date,\n                class_attended__teacher=request.user\n            )\n        else:\n            attendances = Attendance.objects.filter(date=date)\n        \n        total_students = attendances.count()\n        total_income = sum([a.class_attended.fee_per_month / 30 for a in attendances])\n        \n        return Response({\n            'date': date,\n            'total_students': total_students,\n            'total_income': round(total_income, 2),\n            'attendances': AttendanceSerializer(attendances, many=True).data\n        })\n","size_bytes":3529},"backend/attendance/urls.py":{"content":"from django.urls import path\nfrom .views import AttendanceListView, MarkAttendanceView, DailyReportView\n\nurlpatterns = [\n    path('', AttendanceListView.as_view(), name='attendance-list'),\n    path('mark/', MarkAttendanceView.as_view(), name='mark-attendance'),\n    path('daily-report/', DailyReportView.as_view(), name='daily-report'),\n]\n","size_bytes":339},"backend/students/migrations/0001_initial.py":{"content":"# Generated by Django 4.2.7 on 2025-11-06 05:08\n\nfrom django.conf import settings\nfrom django.db import migrations, models\nimport django.db.models.deletion\n\n\nclass Migration(migrations.Migration):\n\n    initial = True\n\n    dependencies = [\n        migrations.swappable_dependency(settings.AUTH_USER_MODEL),\n        ('classes', '0001_initial'),\n    ]\n\n    operations = [\n        migrations.CreateModel(\n            name='Student',\n            fields=[\n                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),\n                ('full_name', models.CharField(max_length=200)),\n                ('date_of_birth', models.DateField()),\n                ('parent_name', models.CharField(max_length=200)),\n                ('parent_phone', models.CharField(max_length=15)),\n                ('parent_email', models.EmailField(blank=True, max_length=254)),\n                ('address', models.TextField()),\n                ('qr_code', models.ImageField(blank=True, upload_to='qr_codes/')),\n                ('enrollment_date', models.DateField(auto_now_add=True)),\n                ('is_active', models.BooleanField(default=True)),\n                ('created_at', models.DateTimeField(auto_now_add=True)),\n                ('updated_at', models.DateTimeField(auto_now=True)),\n                ('assigned_class', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='students', to='classes.class')),\n                ('user', models.OneToOneField(limit_choices_to={'role': 'student'}, on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL)),\n            ],\n        ),\n    ]\n","size_bytes":1666},"backend/classes/views.py":{"content":"from rest_framework import generics, permissions\nfrom .models import Class\nfrom .serializers import ClassSerializer\nfrom accounts.permissions import IsOwner, IsOwnerOrTeacher\n\nclass ClassListCreateView(generics.ListCreateAPIView):\n    queryset = Class.objects.all()\n    serializer_class = ClassSerializer\n    \n    def get_permissions(self):\n        if self.request.method == 'POST':\n            return [IsOwner()]\n        return [IsOwnerOrTeacher()]\n\nclass ClassDetailView(generics.RetrieveUpdateDestroyAPIView):\n    queryset = Class.objects.all()\n    serializer_class = ClassSerializer\n    \n    def get_permissions(self):\n        if self.request.method in ['GET']:\n            return [IsOwnerOrTeacher()]\n        return [IsOwner()]\n","size_bytes":733},"backend/accounts/migrations/__init__.py":{"content":"","size_bytes":0},"backend/accounts/apps.py":{"content":"from django.apps import AppConfig\n\n\nclass AccountsConfig(AppConfig):\n    default_auto_field = 'django.db.models.BigAutoField'\n    name = 'accounts'\n","size_bytes":148},"frontend/src/lib/utils.js":{"content":"import { clsx } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs) {\n  return twMerge(clsx(inputs))\n}\n","size_bytes":135},"backend/tuition_manager/asgi.py":{"content":"\"\"\"\nASGI config for tuition_manager project.\n\nIt exposes the ASGI callable as a module-level variable named ``application``.\n\nFor more information on this file, see\nhttps://docs.djangoproject.com/en/4.2/howto/deployment/asgi/\n\"\"\"\n\nimport os\n\nfrom django.core.asgi import get_asgi_application\n\nos.environ.setdefault('DJANGO_SETTINGS_MODULE', 'tuition_manager.settings')\n\napplication = get_asgi_application()\n","size_bytes":407},"backend/payments/migrations/__init__.py":{"content":"","size_bytes":0},"backend/attendance/__init__.py":{"content":"","size_bytes":0},"backend/utils/sms.py":{"content":"from django.conf import settings\nfrom twilio.rest import Client\n\ndef send_sms(to_phone, message):\n    if not all([settings.TWILIO_ACCOUNT_SID, settings.TWILIO_AUTH_TOKEN, settings.TWILIO_PHONE_NUMBER]):\n        print(f\"Twilio not configured. Would send SMS to {to_phone}: {message}\")\n        return False\n    \n    try:\n        client = Client(settings.TWILIO_ACCOUNT_SID, settings.TWILIO_AUTH_TOKEN)\n        \n        message = client.messages.create(\n            body=message,\n            from_=settings.TWILIO_PHONE_NUMBER,\n            to=to_phone\n        )\n        \n        return True\n    except Exception as e:\n        print(f\"Failed to send SMS: {str(e)}\")\n        return False\n\ndef send_attendance_sms(student, class_name):\n    message = f\"Your child {student.full_name} has arrived for {class_name}.\"\n    return send_sms(student.parent_phone, message)\n\ndef send_payment_sms(student, month, year):\n    message = f\"Your child's class fee for {month.capitalize()} {year} has been received.\"\n    return send_sms(student.parent_phone, message)\n","size_bytes":1046},"backend/students/__init__.py":{"content":"","size_bytes":0},"backend/students/serializers.py":{"content":"from rest_framework import serializers\nfrom .models import Student\nfrom classes.models import Class\n\nclass StudentSerializer(serializers.ModelSerializer):\n    username = serializers.CharField(source='user.username', read_only=True)\n    class_name = serializers.CharField(source='assigned_class.name', read_only=True)\n    qr_code_url = serializers.SerializerMethodField()\n    \n    class Meta:\n        model = Student\n        fields = ['id', 'user', 'username', 'full_name', 'date_of_birth', 'parent_name', \n                  'parent_phone', 'parent_email', 'address', 'assigned_class', 'class_name',\n                  'qr_code', 'qr_code_url', 'enrollment_date', 'is_active', 'created_at']\n        read_only_fields = ['id', 'qr_code', 'enrollment_date', 'created_at']\n    \n    def get_qr_code_url(self, obj):\n        if obj.qr_code:\n            return obj.qr_code.url\n        return None\n\nclass StudentCreateSerializer(serializers.ModelSerializer):\n    username = serializers.CharField(write_only=True)\n    password = serializers.CharField(write_only=True)\n    \n    class Meta:\n        model = Student\n        fields = ['username', 'password', 'full_name', 'date_of_birth', 'parent_name', \n                  'parent_phone', 'parent_email', 'address', 'assigned_class']\n    \n    def create(self, validated_data):\n        from django.contrib.auth import get_user_model\n        User = get_user_model()\n        \n        username = validated_data.pop('username')\n        password = validated_data.pop('password')\n        \n        user = User.objects.create_user(\n            username=username,\n            password=password,\n            role='student'\n        )\n        \n        student = Student.objects.create(user=user, **validated_data)\n        return student\n","size_bytes":1758},"backend/payments/__init__.py":{"content":"","size_bytes":0},"frontend/src/pages/OwnerDashboard.jsx":{"content":"import { useAuth } from '../contexts/AuthContext'\nimport { useNavigate } from 'react-router-dom'\n\nfunction OwnerDashboard() {\n  const { user, logout } = useAuth()\n  const navigate = useNavigate()\n\n  const handleLogout = () => {\n    logout()\n    navigate('/login')\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      <nav className=\"bg-white shadow-sm\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <div className=\"flex justify-between h-16 items-center\">\n            <h1 className=\"text-xl font-bold text-gray-900\">Smart Tuition Manager - Owner Dashboard</h1>\n            <div className=\"flex items-center gap-4\">\n              <span className=\"text-gray-700\">Welcome, {user?.first_name || user?.username}</span>\n              <button\n                onClick={handleLogout}\n                className=\"bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700\"\n              >\n                Logout\n              </button>\n            </div>\n          </div>\n        </div>\n      </nav>\n      \n      <main className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8\">\n          <div className=\"bg-white p-6 rounded-lg shadow\">\n            <h3 className=\"text-lg font-semibold text-gray-700 mb-2\">Total Students</h3>\n            <p className=\"text-3xl font-bold text-blue-600\">Coming Soon</p>\n          </div>\n          <div className=\"bg-white p-6 rounded-lg shadow\">\n            <h3 className=\"text-lg font-semibold text-gray-700 mb-2\">Total Classes</h3>\n            <p className=\"text-3xl font-bold text-green-600\">Coming Soon</p>\n          </div>\n          <div className=\"bg-white p-6 rounded-lg shadow\">\n            <h3 className=\"text-lg font-semibold text-gray-700 mb-2\">Monthly Income</h3>\n            <p className=\"text-3xl font-bold text-purple-600\">Coming Soon</p>\n          </div>\n        </div>\n        \n        <div className=\"bg-white rounded-lg shadow p-6\">\n          <h2 className=\"text-2xl font-bold text-gray-800 mb-4\">Dashboard Features</h2>\n          <ul className=\"space-y-2 text-gray-600\">\n            <li>✓ Student Management (Add, Edit, Delete)</li>\n            <li>✓ Teacher Management</li>\n            <li>✓ Class Management</li>\n            <li>✓ QR Code Generation for Students</li>\n            <li>✓ Payment Tracking</li>\n            <li>✓ Attendance Reports</li>\n            <li>✓ SMS Notifications</li>\n            <li className=\"text-blue-600 font-semibold mt-4\">Full functionality will be implemented in the next phase.</li>\n          </ul>\n        </div>\n      </main>\n    </div>\n  )\n}\n\nexport default OwnerDashboard\n","size_bytes":2678},"backend/payments/views.py":{"content":"from rest_framework import generics, permissions, status\nfrom rest_framework.views import APIView\nfrom rest_framework.response import Response\nfrom django.utils import timezone\nfrom .models import Payment\nfrom .serializers import PaymentSerializer\nfrom utils.sms import send_payment_sms\nfrom accounts.permissions import IsOwner, IsOwnerOrTeacher\n\nclass PaymentListCreateView(generics.ListCreateAPIView):\n    queryset = Payment.objects.all()\n    serializer_class = PaymentSerializer\n    \n    def get_permissions(self):\n        if self.request.method == 'POST':\n            return [IsOwner()]\n        return [IsOwnerOrTeacher()]\n    \n    def get_queryset(self):\n        queryset = Payment.objects.all()\n        student_id = self.request.query_params.get('student_id', None)\n        status = self.request.query_params.get('status', None)\n        \n        if student_id:\n            queryset = queryset.filter(student_id=student_id)\n        if status:\n            queryset = queryset.filter(status=status)\n        \n        return queryset\n\nclass PaymentDetailView(generics.RetrieveUpdateDestroyAPIView):\n    queryset = Payment.objects.all()\n    serializer_class = PaymentSerializer\n    \n    def get_permissions(self):\n        if self.request.method in ['GET']:\n            return [IsOwnerOrTeacher()]\n        return [IsOwner()]\n    \n    def perform_update(self, serializer):\n        instance = serializer.save()\n        \n        if instance.status == 'paid' and not instance.sms_sent:\n            sms_sent = send_payment_sms(\n                instance.student, \n                instance.get_month_display(), \n                instance.year\n            )\n            instance.sms_sent = sms_sent\n            instance.save()\n\nclass OutstandingPaymentsView(APIView):\n    permission_classes = (IsOwnerOrTeacher,)\n    \n    def get(self, request):\n        outstanding = Payment.objects.filter(status__in=['pending', 'overdue'])\n        return Response(PaymentSerializer(outstanding, many=True).data)\n\nclass MonthlyIncomeReportView(APIView):\n    permission_classes = (IsOwnerOrTeacher,)\n    \n    def get(self, request):\n        month = request.query_params.get('month')\n        year = request.query_params.get('year')\n        \n        if not month or not year:\n            return Response(\n                {'error': 'Month and year parameters required'}, \n                status=status.HTTP_400_BAD_REQUEST\n            )\n        \n        payments = Payment.objects.filter(\n            month=month.lower(),\n            year=int(year),\n            status='paid'\n        )\n        \n        total_income = sum([p.amount for p in payments])\n        \n        return Response({\n            'month': month,\n            'year': year,\n            'total_payments': payments.count(),\n            'total_income': total_income,\n            'payments': PaymentSerializer(payments, many=True).data\n        })\n","size_bytes":2881},"backend/accounts/models.py":{"content":"from django.contrib.auth.models import AbstractUser\nfrom django.db import models\n\nclass User(AbstractUser):\n    ROLE_CHOICES = (\n        ('owner', 'Owner'),\n        ('teacher', 'Teacher'),\n        ('student', 'Student'),\n    )\n    \n    role = models.CharField(max_length=10, choices=ROLE_CHOICES, default='student')\n    phone = models.CharField(max_length=15, blank=True)\n    \n    def __str__(self):\n        return f\"{self.username} ({self.get_role_display()})\"\n","size_bytes":462},"frontend/src/pages/TeacherDashboard.jsx":{"content":"import { useAuth } from '../contexts/AuthContext'\nimport { useNavigate } from 'react-router-dom'\n\nfunction TeacherDashboard() {\n  const { user, logout } = useAuth()\n  const navigate = useNavigate()\n\n  const handleLogout = () => {\n    logout()\n    navigate('/login')\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      <nav className=\"bg-white shadow-sm\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <div className=\"flex justify-between h-16 items-center\">\n            <h1 className=\"text-xl font-bold text-gray-900\">Smart Tuition Manager - Teacher Dashboard</h1>\n            <div className=\"flex items-center gap-4\">\n              <span className=\"text-gray-700\">Welcome, {user?.first_name || user?.username}</span>\n              <button\n                onClick={handleLogout}\n                className=\"bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700\"\n              >\n                Logout\n              </button>\n            </div>\n          </div>\n        </div>\n      </nav>\n      \n      <main className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8\">\n          <div className=\"bg-white p-6 rounded-lg shadow\">\n            <h3 className=\"text-lg font-semibold text-gray-700 mb-2\">Today's Attendance</h3>\n            <p className=\"text-3xl font-bold text-blue-600\">Coming Soon</p>\n          </div>\n          <div className=\"bg-white p-6 rounded-lg shadow\">\n            <h3 className=\"text-lg font-semibold text-gray-700 mb-2\">Daily Income</h3>\n            <p className=\"text-3xl font-bold text-green-600\">Coming Soon</p>\n          </div>\n        </div>\n        \n        <div className=\"bg-white rounded-lg shadow p-6\">\n          <h2 className=\"text-2xl font-bold text-gray-800 mb-4\">Teacher Features</h2>\n          <ul className=\"space-y-2 text-gray-600\">\n            <li>✓ QR Code Scanner for Attendance</li>\n            <li>✓ View Daily Attendance List</li>\n            <li>✓ View Student Information</li>\n            <li>✓ Daily Reports</li>\n            <li className=\"text-blue-600 font-semibold mt-4\">Full functionality will be implemented in the next phase.</li>\n          </ul>\n        </div>\n      </main>\n    </div>\n  )\n}\n\nexport default TeacherDashboard\n","size_bytes":2303},"frontend/src/main.jsx":{"content":"import React from 'react'\nimport ReactDOM from 'react-dom/client'\nimport App from './App'\nimport './index.css'\n\nReactDOM.createRoot(document.getElementById('root')).render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>\n)\n","size_bytes":230},"pyproject.toml":{"content":"[project]\nname = \"repl-nix-workspace\"\nversion = \"0.1.0\"\ndescription = \"Add your description here\"\nrequires-python = \">=3.12\"\ndependencies = [\n    \"django==4.2.7\",\n    \"django-cors-headers==4.3.0\",\n    \"djangorestframework==3.14.0\",\n    \"djangorestframework-simplejwt==5.3.0\",\n    \"pillow==10.1.0\",\n    \"qrcode==7.4.2\",\n    \"twilio==8.10.0\",\n]\n","size_bytes":343},"backend/accounts/views.py":{"content":"from rest_framework import generics, status, permissions\nfrom rest_framework.response import Response\nfrom rest_framework.views import APIView\nfrom rest_framework_simplejwt.tokens import RefreshToken\nfrom django.contrib.auth import get_user_model, authenticate\nfrom .serializers import RegisterSerializer, UserSerializer, TeacherSerializer\nfrom .permissions import IsOwner\n\nUser = get_user_model()\n\nclass RegisterView(generics.CreateAPIView):\n    queryset = User.objects.all()\n    permission_classes = (permissions.AllowAny,)\n    serializer_class = RegisterSerializer\n    \n    def perform_create(self, serializer):\n        serializer.save(role='student')\n\nclass LoginView(APIView):\n    permission_classes = (permissions.AllowAny,)\n    \n    def post(self, request):\n        username = request.data.get('username')\n        password = request.data.get('password')\n        \n        user = authenticate(username=username, password=password)\n        \n        if user:\n            refresh = RefreshToken.for_user(user)\n            return Response({\n                'refresh': str(refresh),\n                'access': str(refresh.access_token),\n                'user': UserSerializer(user).data\n            })\n        \n        return Response({'error': 'Invalid credentials'}, status=status.HTTP_401_UNAUTHORIZED)\n\nclass CurrentUserView(APIView):\n    permission_classes = (permissions.IsAuthenticated,)\n    \n    def get(self, request):\n        serializer = UserSerializer(request.user)\n        return Response(serializer.data)\n\nclass TeacherListView(generics.ListAPIView):\n    queryset = User.objects.filter(role='teacher')\n    serializer_class = TeacherSerializer\n    permission_classes = (IsOwner,)\n\nclass TeacherCreateView(generics.CreateAPIView):\n    queryset = User.objects.all()\n    serializer_class = RegisterSerializer\n    permission_classes = (IsOwner,)\n    \n    def perform_create(self, serializer):\n        serializer.save(role='teacher')\n","size_bytes":1941},"backend/accounts/migrations/0001_initial.py":{"content":"# Generated by Django 4.2.7 on 2025-11-06 05:08\n\nimport django.contrib.auth.models\nimport django.contrib.auth.validators\nfrom django.db import migrations, models\nimport django.utils.timezone\n\n\nclass Migration(migrations.Migration):\n\n    initial = True\n\n    dependencies = [\n        ('auth', '0012_alter_user_first_name_max_length'),\n    ]\n\n    operations = [\n        migrations.CreateModel(\n            name='User',\n            fields=[\n                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),\n                ('password', models.CharField(max_length=128, verbose_name='password')),\n                ('last_login', models.DateTimeField(blank=True, null=True, verbose_name='last login')),\n                ('is_superuser', models.BooleanField(default=False, help_text='Designates that this user has all permissions without explicitly assigning them.', verbose_name='superuser status')),\n                ('username', models.CharField(error_messages={'unique': 'A user with that username already exists.'}, help_text='Required. 150 characters or fewer. Letters, digits and @/./+/-/_ only.', max_length=150, unique=True, validators=[django.contrib.auth.validators.UnicodeUsernameValidator()], verbose_name='username')),\n                ('first_name', models.CharField(blank=True, max_length=150, verbose_name='first name')),\n                ('last_name', models.CharField(blank=True, max_length=150, verbose_name='last name')),\n                ('email', models.EmailField(blank=True, max_length=254, verbose_name='email address')),\n                ('is_staff', models.BooleanField(default=False, help_text='Designates whether the user can log into this admin site.', verbose_name='staff status')),\n                ('is_active', models.BooleanField(default=True, help_text='Designates whether this user should be treated as active. Unselect this instead of deleting accounts.', verbose_name='active')),\n                ('date_joined', models.DateTimeField(default=django.utils.timezone.now, verbose_name='date joined')),\n                ('role', models.CharField(choices=[('owner', 'Owner'), ('teacher', 'Teacher'), ('student', 'Student')], default='student', max_length=10)),\n                ('phone', models.CharField(blank=True, max_length=15)),\n                ('groups', models.ManyToManyField(blank=True, help_text='The groups this user belongs to. A user will get all permissions granted to each of their groups.', related_name='user_set', related_query_name='user', to='auth.group', verbose_name='groups')),\n                ('user_permissions', models.ManyToManyField(blank=True, help_text='Specific permissions for this user.', related_name='user_set', related_query_name='user', to='auth.permission', verbose_name='user permissions')),\n            ],\n            options={\n                'verbose_name': 'user',\n                'verbose_name_plural': 'users',\n                'abstract': False,\n            },\n            managers=[\n                ('objects', django.contrib.auth.models.UserManager()),\n            ],\n        ),\n    ]\n","size_bytes":3101},"backend/accounts/urls.py":{"content":"from django.urls import path\nfrom .views import RegisterView, LoginView, CurrentUserView, TeacherListView, TeacherCreateView\n\nurlpatterns = [\n    path('register/', RegisterView.as_view(), name='register'),\n    path('login/', LoginView.as_view(), name='login'),\n    path('me/', CurrentUserView.as_view(), name='current-user'),\n    path('teachers/', TeacherListView.as_view(), name='teacher-list'),\n    path('teachers/create/', TeacherCreateView.as_view(), name='teacher-create'),\n]\n","size_bytes":481},"backend/payments/serializers.py":{"content":"from rest_framework import serializers\nfrom .models import Payment\n\nclass PaymentSerializer(serializers.ModelSerializer):\n    student_name = serializers.CharField(source='student.full_name', read_only=True)\n    class_name = serializers.CharField(source='class_fee.name', read_only=True)\n    received_by_name = serializers.CharField(source='received_by.get_full_name', read_only=True)\n    month_display = serializers.CharField(source='get_month_display', read_only=True)\n    \n    class Meta:\n        model = Payment\n        fields = ['id', 'student', 'student_name', 'class_fee', 'class_name', 'month', \n                  'month_display', 'year', 'amount', 'status', 'payment_date', \n                  'received_by', 'received_by_name', 'sms_sent', 'notes', 'created_at', 'updated_at']\n        read_only_fields = ['id', 'sms_sent', 'created_at', 'updated_at']\n","size_bytes":859},"backend/accounts/tests.py":{"content":"from django.test import TestCase\n\n# Create your tests here.\n","size_bytes":60},"backend/payments/models.py":{"content":"from django.db import models\nfrom django.conf import settings\nfrom students.models import Student\nfrom classes.models import Class\n\nclass Payment(models.Model):\n    MONTH_CHOICES = (\n        ('january', 'January'),\n        ('february', 'February'),\n        ('march', 'March'),\n        ('april', 'April'),\n        ('may', 'May'),\n        ('june', 'June'),\n        ('july', 'July'),\n        ('august', 'August'),\n        ('september', 'September'),\n        ('october', 'October'),\n        ('november', 'November'),\n        ('december', 'December'),\n    )\n    \n    STATUS_CHOICES = (\n        ('paid', 'Paid'),\n        ('pending', 'Pending'),\n        ('overdue', 'Overdue'),\n    )\n    \n    student = models.ForeignKey(Student, on_delete=models.CASCADE, related_name='payments')\n    class_fee = models.ForeignKey(Class, on_delete=models.CASCADE, related_name='payments')\n    month = models.CharField(max_length=15, choices=MONTH_CHOICES)\n    year = models.IntegerField()\n    amount = models.DecimalField(max_digits=10, decimal_places=2)\n    status = models.CharField(max_length=10, choices=STATUS_CHOICES, default='pending')\n    payment_date = models.DateField(null=True, blank=True)\n    received_by = models.ForeignKey(\n        settings.AUTH_USER_MODEL, \n        on_delete=models.SET_NULL, \n        null=True,\n        blank=True,\n        limit_choices_to={'role__in': ['owner', 'teacher']}\n    )\n    sms_sent = models.BooleanField(default=False)\n    notes = models.TextField(blank=True)\n    created_at = models.DateTimeField(auto_now_add=True)\n    updated_at = models.DateTimeField(auto_now=True)\n    \n    class Meta:\n        unique_together = ['student', 'class_fee', 'month', 'year']\n        ordering = ['-year', '-created_at']\n    \n    def __str__(self):\n        return f\"{self.student.full_name} - {self.month} {self.year} - {self.status}\"\n","size_bytes":1840},"backend/classes/serializers.py":{"content":"from rest_framework import serializers\nfrom .models import Class\n\nclass ClassSerializer(serializers.ModelSerializer):\n    teacher_name = serializers.CharField(source='teacher.get_full_name', read_only=True)\n    student_count = serializers.SerializerMethodField()\n    \n    class Meta:\n        model = Class\n        fields = ['id', 'name', 'subject', 'teacher', 'teacher_name', 'fee_per_month', \n                  'schedule', 'student_count', 'created_at', 'updated_at']\n        read_only_fields = ['id', 'created_at', 'updated_at']\n    \n    def get_student_count(self, obj):\n        return obj.students.count()\n","size_bytes":610},"backend/payments/migrations/0001_initial.py":{"content":"# Generated by Django 4.2.7 on 2025-11-06 05:08\n\nfrom django.conf import settings\nfrom django.db import migrations, models\nimport django.db.models.deletion\n\n\nclass Migration(migrations.Migration):\n\n    initial = True\n\n    dependencies = [\n        migrations.swappable_dependency(settings.AUTH_USER_MODEL),\n        ('students', '0001_initial'),\n        ('classes', '0001_initial'),\n    ]\n\n    operations = [\n        migrations.CreateModel(\n            name='Payment',\n            fields=[\n                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),\n                ('month', models.CharField(choices=[('january', 'January'), ('february', 'February'), ('march', 'March'), ('april', 'April'), ('may', 'May'), ('june', 'June'), ('july', 'July'), ('august', 'August'), ('september', 'September'), ('october', 'October'), ('november', 'November'), ('december', 'December')], max_length=15)),\n                ('year', models.IntegerField()),\n                ('amount', models.DecimalField(decimal_places=2, max_digits=10)),\n                ('status', models.CharField(choices=[('paid', 'Paid'), ('pending', 'Pending'), ('overdue', 'Overdue')], default='pending', max_length=10)),\n                ('payment_date', models.DateField(blank=True, null=True)),\n                ('sms_sent', models.BooleanField(default=False)),\n                ('notes', models.TextField(blank=True)),\n                ('created_at', models.DateTimeField(auto_now_add=True)),\n                ('updated_at', models.DateTimeField(auto_now=True)),\n                ('class_fee', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='payments', to='classes.class')),\n                ('received_by', models.ForeignKey(blank=True, limit_choices_to={'role__in': ['owner', 'teacher']}, null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),\n                ('student', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='payments', to='students.student')),\n            ],\n            options={\n                'ordering': ['-year', '-created_at'],\n                'unique_together': {('student', 'class_fee', 'month', 'year')},\n            },\n        ),\n    ]\n","size_bytes":2258},"backend/payments/tests.py":{"content":"from django.test import TestCase\n\n# Create your tests here.\n","size_bytes":60},"backend/attendance/models.py":{"content":"from django.db import models\nfrom django.conf import settings\nfrom students.models import Student\nfrom classes.models import Class\n\nclass Attendance(models.Model):\n    student = models.ForeignKey(Student, on_delete=models.CASCADE, related_name='attendances')\n    class_attended = models.ForeignKey(Class, on_delete=models.CASCADE, related_name='attendances')\n    date = models.DateField(auto_now_add=True)\n    time = models.TimeField(auto_now_add=True)\n    marked_by = models.ForeignKey(\n        settings.AUTH_USER_MODEL, \n        on_delete=models.SET_NULL, \n        null=True,\n        limit_choices_to={'role__in': ['owner', 'teacher']}\n    )\n    sms_sent = models.BooleanField(default=False)\n    created_at = models.DateTimeField(auto_now_add=True)\n    \n    class Meta:\n        unique_together = ['student', 'class_attended', 'date']\n        ordering = ['-date', '-time']\n    \n    def __str__(self):\n        return f\"{self.student.full_name} - {self.class_attended.name} - {self.date}\"\n","size_bytes":988},"backend/classes/__init__.py":{"content":"","size_bytes":0},"README.md":{"content":"\"# smart-class-mis\" \n","size_bytes":21},"frontend/src/utils/api.js":{"content":"import axios from 'axios'\n\nconst api = axios.create({\n  baseURL: '/api',\n  headers: {\n    'Content-Type': 'application/json',\n  },\n})\n\napi.interceptors.request.use(\n  (config) => {\n    const token = localStorage.getItem('token')\n    if (token) {\n      config.headers.Authorization = `Bearer ${token}`\n    }\n    return config\n  },\n  (error) => Promise.reject(error)\n)\n\nexport default api\n","size_bytes":387},"backend/payments/admin.py":{"content":"from django.contrib import admin\n\n# Register your models here.\n","size_bytes":63},"replit.md":{"content":"# Smart Tuition Manager\n\n## Overview\nA comprehensive Student Management System for private tuition classes built with Django REST Framework (backend) and React (frontend). The system enables role-based management for Owners, Teachers, and Students with features including QR code-based attendance tracking, payment management, and automated SMS notifications to parents.\n\n## Project Status\n**Current State**: Backend API and basic frontend authentication are fully implemented and running.\n\n**Last Updated**: November 6, 2025\n\n## Recent Changes\n- **November 6, 2025**: Initial project setup complete with security hardening\n  - Django backend with REST API fully configured\n  - React frontend with authentication and routing set up\n  - Database models created for User, Student, Class, Attendance, and Payment\n  - JWT authentication implemented\n  - **Role-based access control (RBAC) implemented**:\n    - Custom permission classes: IsOwner, IsOwnerOrTeacher, IsTeacher\n    - Registration forced to 'student' role - prevents privilege escalation\n    - Teacher creation restricted to owners only\n    - All management APIs (students, classes, payments) require owner permissions\n    - Attendance operations require owner or teacher permissions\n  - QR code generation functionality added\n  - Twilio SMS integration configured\n  - Basic Owner and Teacher dashboards created\n\n## Tech Stack\n- **Frontend**: React 18 + Vite + TailwindCSS + Shadcn UI components\n- **Backend**: Django 4.2.7 + Django REST Framework\n- **Database**: SQLite (db.sqlite3)\n- **Authentication**: JWT (djangorestframework-simplejwt)\n- **QR Codes**: Python qrcode library\n- **SMS**: Twilio API\n- **Development Server**: Django runs on port 8000, React/Vite runs on port 5000\n\n## Project Architecture\n\n### Backend Structure (`/backend`)\n```\nbackend/\n├── tuition_manager/         # Main Django project\n│   ├── settings.py          # Project settings with CORS, JWT, Twilio config\n│   └── urls.py              # Main URL routing\n├── accounts/                # User authentication and management\n│   ├── models.py            # Custom User model with roles\n│   ├── serializers.py       # User, Register, Teacher serializers\n│   ├── views.py             # Login, Register, Current User endpoints\n│   └── urls.py              # Auth routes\n├── students/                # Student management\n│   ├── models.py            # Student model with QR code generation\n│   ├── serializers.py       # Student serializers\n│   ├── views.py             # Student CRUD endpoints\n│   └── urls.py              # Student routes\n├── classes/                 # Class management\n│   ├── models.py            # Class model\n│   ├── serializers.py       # Class serializers\n│   ├── views.py             # Class CRUD endpoints\n│   └── urls.py              # Class routes\n├── attendance/              # Attendance tracking\n│   ├── models.py            # Attendance model\n│   ├── serializers.py       # Attendance and QR scanning serializers\n│   ├── views.py             # Attendance marking and daily reports\n│   └── urls.py              # Attendance routes\n├── payments/                # Payment management\n│   ├── models.py            # Payment model\n│   ├── serializers.py       # Payment serializers\n│   ├── views.py             # Payment CRUD and reports\n│   └── urls.py              # Payment routes\n└── utils/                   # Utilities\n    └── sms.py               # Twilio SMS helper functions\n```\n\n### Frontend Structure (`/frontend`)\n```\nfrontend/\n├── src/\n│   ├── components/          # Reusable UI components (to be added)\n│   ├── pages/\n│   │   ├── Login.jsx        # Login page\n│   │   ├── OwnerDashboard.jsx    # Owner dashboard (basic)\n│   │   └── TeacherDashboard.jsx  # Teacher dashboard (basic)\n│   ├── contexts/\n│   │   └── AuthContext.jsx  # Authentication context and state\n│   ├── utils/\n│   │   └── api.js           # Axios instance with JWT interceptors\n│   ├── lib/\n│   │   └── utils.js         # Utility functions (cn for classnames)\n│   ├── App.jsx              # Main app with routing\n│   ├── main.jsx             # React entry point\n│   └── index.css            # Tailwind CSS with custom theme\n├── vite.config.js           # Vite configuration with proxy to Django\n├── tailwind.config.js       # Tailwind CSS configuration\n└── package.json             # Node dependencies\n```\n\n## Database Models\n\n### User (Custom AbstractUser)\n- Fields: username, email, password, role (owner/teacher/student), phone\n- Roles: Owner, Teacher, Student\n\n### Student\n- Fields: user (OneToOne), full_name, date_of_birth, parent_name, parent_phone, parent_email, address, assigned_class, qr_code (auto-generated), enrollment_date, is_active\n- Auto-generates QR code on creation: format `STUDENT:{id}:{name}`\n\n### Class\n- Fields: name, subject, teacher (ForeignKey to User), fee_per_month, schedule, created_at, updated_at\n\n### Attendance\n- Fields: student, class_attended, date, time, marked_by, sms_sent\n- Unique constraint: student + class + date (prevents duplicate attendance)\n- Triggers SMS notification to parent when marked\n\n### Payment\n- Fields: student, class_fee, month, year, amount, status (paid/pending/overdue), payment_date, received_by, sms_sent, notes\n- Unique constraint: student + class + month + year\n- Triggers SMS notification when status changes to 'paid'\n\n## API Endpoints\n\n### Authentication (`/api/auth/`)\n- POST `/register/` - Register new user\n- POST `/login/` - Login and get JWT token\n- GET `/me/` - Get current user info\n- GET `/teachers/` - List all teachers\n- POST `/teachers/create/` - Create new teacher (Owner only)\n\n### Students (`/api/students/`)\n- GET `/` - List all students\n- POST `/` - Create new student (with auto QR generation)\n- GET `/{id}/` - Get student details\n- PUT `/{id}/` - Update student\n- DELETE `/{id}/` - Delete student\n\n### Classes (`/api/classes/`)\n- GET `/` - List all classes\n- POST `/` - Create new class\n- GET `/{id}/` - Get class details\n- PUT `/{id}/` - Update class\n- DELETE `/{id}/` - Delete class\n\n### Attendance (`/api/attendance/`)\n- GET `/` - List attendance (filterable by date, class, student)\n- POST `/mark/` - Mark attendance by scanning QR code\n- GET `/daily-report/` - Get daily attendance and income report\n\n### Payments (`/api/payments/`)\n- GET `/` - List payments (filterable by student, status)\n- POST `/` - Create payment record\n- GET `/{id}/` - Get payment details\n- PUT `/{id}/` - Update payment (triggers SMS if status = 'paid')\n- DELETE `/{id}/` - Delete payment\n- GET `/outstanding/` - Get all outstanding payments\n- GET `/monthly-income/` - Get monthly income report (requires month & year params)\n\n## Environment Variables Required\n- `SESSION_SECRET` - Django secret key (already configured)\n- `TWILIO_ACCOUNT_SID` - Twilio account SID (needed for SMS)\n- `TWILIO_AUTH_TOKEN` - Twilio auth token (needed for SMS)\n- `TWILIO_PHONE_NUMBER` - Twilio phone number (needed for SMS)\n\n## Next Steps (Tasks 7-10)\n1. **Task 7**: Build complete Owner dashboard with:\n   - Student management UI (add, edit, delete, view QR codes)\n   - Teacher management UI\n   - Class management UI\n   - Payment tracking and update UI\n   - Comprehensive reports\n\n2. **Task 8**: Build complete Teacher dashboard with:\n   - QR code scanner component\n   - Attendance marking interface\n   - Daily student list view\n   - Daily income calculator\n\n3. **Task 9**: Implement reporting features:\n   - Attendance summary by date/class/student\n   - Monthly and daily income reports with charts\n   - Outstanding payments list\n   - Export functionality (PDF/Excel)\n\n4. **Task 10**: Final testing and integration:\n   - Test all CRUD operations\n   - Verify SMS notifications work\n   - Test QR code generation and scanning\n   - Ensure proper role-based access control\n   - Performance testing\n\n## User Preferences\n- **Stack**: Django + React (as requested)\n- **Database**: SQLite (as requested)\n- **UI Framework**: TailwindCSS with Shadcn components (modern, professional design)\n\n## Development Notes\n- Both backend and frontend run simultaneously via the workflow\n- Vite dev server proxies `/api` and `/media` requests to Django backend\n- CORS is enabled for all origins in development\n- JWT tokens stored in localStorage on frontend\n- QR codes are stored in `/backend/media/qr_codes/`\n- SMS functionality requires Twilio credentials to be configured\n\n## Running the Project\nThe project auto-starts via the configured workflow which runs:\n```bash\ncd backend && python manage.py runserver 0.0.0.0:8000 & cd frontend && npm run dev\n```\n\n- Frontend accessible at: http://localhost:5000\n- Backend API at: http://localhost:8000/api/\n- Admin panel at: http://localhost:8000/admin/\n\n## Architectural Decisions\n- **Custom User Model**: Extended Django's AbstractUser to include role field for role-based access control\n- **QR Code Auto-Generation**: QR codes are automatically generated when a student is created\n- **SMS Integration**: Centralized SMS utility functions in `utils/sms.py` for reusability\n- **JWT Authentication**: Token-based auth for stateless API communication\n- **Role-Based Routing**: Frontend routes protected based on user role (owner/teacher)\n- **Proxy Configuration**: Vite proxies API calls to avoid CORS issues in development\n","size_bytes":9605},"frontend/vite.config.js":{"content":"import { defineConfig } from 'vite'\nimport react from '@vitejs/plugin-react'\nimport path from 'path'\n\nexport default defineConfig({\n  plugins: [react()],\n  server: {\n    host: '0.0.0.0',\n    port: 5000,\n    allowedHosts: true,\n    proxy: {\n      '/api': {\n        target: 'http://127.0.0.1:8000',\n        changeOrigin: true,\n      },\n      '/media': {\n        target: 'http://127.0.0.1:8000',\n        changeOrigin: true,\n      },\n    },\n  },\n  resolve: {\n    alias: {\n      '@': path.resolve(__dirname, './src'),\n    },\n  },\n})\n","size_bytes":528},"backend/classes/models.py":{"content":"from django.db import models\nfrom django.conf import settings\n\nclass Class(models.Model):\n    name = models.CharField(max_length=100)\n    subject = models.CharField(max_length=100)\n    teacher = models.ForeignKey(\n        settings.AUTH_USER_MODEL, \n        on_delete=models.SET_NULL, \n        null=True, \n        related_name='classes_taught',\n        limit_choices_to={'role': 'teacher'}\n    )\n    fee_per_month = models.DecimalField(max_digits=10, decimal_places=2)\n    schedule = models.CharField(max_length=200, help_text=\"e.g., Mon/Wed/Fri 4-6 PM\")\n    created_at = models.DateTimeField(auto_now_add=True)\n    updated_at = models.DateTimeField(auto_now=True)\n    \n    class Meta:\n        verbose_name_plural = \"Classes\"\n    \n    def __str__(self):\n        return f\"{self.name} - {self.subject}\"\n","size_bytes":800},"backend/classes/urls.py":{"content":"from django.urls import path\nfrom .views import ClassListCreateView, ClassDetailView\n\nurlpatterns = [\n    path('', ClassListCreateView.as_view(), name='class-list-create'),\n    path('<int:pk>/', ClassDetailView.as_view(), name='class-detail'),\n]\n","size_bytes":246},"backend/attendance/migrations/__init__.py":{"content":"","size_bytes":0},"backend/students/migrations/__init__.py":{"content":"","size_bytes":0},"backend/classes/admin.py":{"content":"from django.contrib import admin\n\n# Register your models here.\n","size_bytes":63},"backend/payments/urls.py":{"content":"from django.urls import path\nfrom .views import (\n    PaymentListCreateView, \n    PaymentDetailView, \n    OutstandingPaymentsView,\n    MonthlyIncomeReportView\n)\n\nurlpatterns = [\n    path('', PaymentListCreateView.as_view(), name='payment-list-create'),\n    path('<int:pk>/', PaymentDetailView.as_view(), name='payment-detail'),\n    path('outstanding/', OutstandingPaymentsView.as_view(), name='outstanding-payments'),\n    path('monthly-income/', MonthlyIncomeReportView.as_view(), name='monthly-income'),\n]\n","size_bytes":507},"backend/attendance/tests.py":{"content":"from django.test import TestCase\n\n# Create your tests here.\n","size_bytes":60}},"version":2}